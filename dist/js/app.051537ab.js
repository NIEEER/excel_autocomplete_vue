(function(){"use strict";var t={8780:function(t,e,n){var i={};n.r(i),n.d(i,{makeButtonUnFocus:function(){return O}});var a=n(6369),l=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("TranslateExcel")],1)},s=[],o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"hello"},[e("div",{staticStyle:{display:"flex"}},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.$refs.fileInput.click()}}},[t._v(" 导入 "),e("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:t.readExcel}}),e("i",{staticClass:"el-icon-upload el-icon--right"})]),e("el-button",{on:{click:t.recoveryOneStepExcelData}},[t._v("恢复上一步")]),e("el-button",{on:{click:t.recoveryExcelData}},[t._v("恢复到开始")]),e("el-button",{on:{click:t.exportExcel}},[t._v("导出为 Excel")])],1),e("LoadingAnimation",{attrs:{visible:t.loading}}),t.excelData.length>0?e("table",{staticClass:"table"},[e("thead",[e("tr",[e("th",[t._v("操作")]),t._l(t.excelData[0],(function(n,i){return e("th",{key:i},[t._v(" "+t._s(i)+" ")])}))],2)]),e("tbody",t._l(t.paginatedData,(function(n,i){return e("tr",{key:i},[e("td",[e("button",{on:{click:function(e){return t.deleteRow(i,e)}}},[e("i",{staticClass:"el-icon-remove-outline"})])]),t._l(n,(function(t,i){return e("td",{key:i,staticStyle:{padding:"1px"}},[e("auto-complete-input",{attrs:{value:n[i],columnName:i}})],1)}))],2)})),0)]):t._e(),t.excelData.length>0&&t.currentPage===t.totalPages?e("el-button",{staticStyle:{display:"flex"},on:{click:t.addRow}},[t._v("添加行 ")]):t._e(),t.excelData.length?e("div",{staticClass:"pagination"},[e("button",{on:{click:function(e){t.currentPage>1&&t.currentPage--}}},[t._v("上一页")]),e("span",[t._v("一共"+t._s(t.totalPages)+"页 当前页："+t._s(t.currentPage))]),e("button",{on:{click:function(e){t.currentPage<t.totalPages&&t.currentPage++}}},[t._v("下一页")])]):t._e()],1)},r=[],u=(n(7658),n(3767),n(8585),n(8696),n(7092)),c=n(6154),h=function(){var t=this,e=t._self._c;return e("div",{staticClass:"auto-complete"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.inputValue,expression:"inputValue"}],staticClass:"input-style",style:t.cellStyle,domProps:{value:t.inputValue},on:{input:[function(e){e.target.composing||(t.inputValue=e.target.value)},function(e){return t.onInputChange(t.columnName,t.inputValue)}],blur:t.hideSuggestions,focus:t.showSuggestions,keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"])?null:(e.preventDefault(),t.navigateSuggestions(-1))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"])?null:(e.preventDefault(),t.navigateSuggestions(1))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.selectHighlighted.apply(null,arguments))},function(e){return(e.type.indexOf("key")||89===e.keyCode)&&e.ctrlKey?(e.preventDefault(),t.reset.apply(null,arguments)):null}]}}),e("ul",{directives:[{name:"show",rawName:"v-show",value:t.showSuggestionList,expression:"showSuggestionList"}],staticClass:"suggestion-list"},t._l(t.filteredData,(function(n,i){return e("li",{key:i,class:{highlighted:t.highlightedIndex===i},on:{click:function(e){return t.selectItem(n)}}},[t._v(" "+t._s(n)+" ")])})),0)])},d=[],g=n(4161);g.Z.defaults.baseURL="http://192.168.31.13:10000";const p=n(7265);var f={props:{value:String,columnName:String},data(){return{oldValue:this.value,inputValue:this.value,showSuggestionList:!1,filteredData:[],highlightedIndex:-1,cellStyle:{}}},watch:{value(t){this.inputValue=t}},methods:{async getCellStyle(t,e){this.$set(this,"cellStyle",{borderColor:"#ffff00"});let n="";await g.Z.get(p.columnValueExist,{params:{columnName:t,inputValue:e}}).then((t=>{n=t.data.data?"":"#ff0000",this.$set(this,"cellStyle",{borderColor:n})})).catch((t=>{console.log(t)}))},getFilteredData(t,e){g.Z.get(p.columnValueList,{params:{columnName:t,inputValue:e},timeout:800}).then((t=>{this.$set(this,"filteredData",t.data.data)}))},onInputChange(t,e){this.getFilteredData(t,e),this.$emit("input",this.inputValue)},selectItem(t){this.inputValue=t,this.$emit("input",this.inputValue),this.hideSuggestions()},showSuggestions(){this.getFilteredData(this.columnName,this.inputValue),this.showSuggestionList=!0},hideSuggestions(){this.getCellStyle(this.columnName,this.inputValue),setTimeout((()=>{this.showSuggestionList=!1}),200)},navigateSuggestions(t){this.showSuggestionList&&(this.highlightedIndex+=t,this.highlightedIndex<0?this.highlightedIndex=this.filteredData.length-1:this.highlightedIndex>=this.filteredData.length&&(this.highlightedIndex=0))},selectHighlighted(){this.highlightedIndex>=0&&this.highlightedIndex<this.filteredData.length&&this.selectItem(this.filteredData[this.highlightedIndex])},reset(){this.inputValue=this.oldValue,this.$emit("input",this.oldValue)}},mounted(){this.getCellStyle(this.columnName,this.value)}},v=f,y=n(1001),m=(0,y.Z)(v,h,d,!1,null,"2bfacb80",null),x=m.exports,S=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"loading-mask"},[e("div",{staticClass:"loading-spinner"})])},b=[],D={props:{visible:Boolean}},_=D,w=(0,y.Z)(_,S,b,!1,null,null,null),k=w.exports;const O=t=>{let e=t.target;"I"!==e.nodeName&&"SPAN"!==e.nodeName||(e=t.target.parentNode),e.blur()};var V={name:"TranslateExcel",components:{LoadingAnimation:k,AutoCompleteInput:x},data(){return{excelData:[],oldExcelData:[],recoveryData:[],currentPage:1,pageSize:20,loading:!1}},props:{},watch:{},methods:{addRow(t){this.oldExcelData.push(JSON.stringify(this.excelData));const e=Object.keys(this.excelData[0]),n={};for(const i of e)n[i]="";this.excelData.push(n),O(t)},deleteRow(t,e){this.oldExcelData.push(JSON.stringify(this.excelData)),this.excelData.splice(t,1),O(e)},recoveryOneStepExcelData(t){try{if(this.oldExcelData.length<1)return alert("已恢复到最初位置"),void O(t);this.$set(this,"excelData",JSON.parse(this.oldExcelData.pop()))}catch(e){alert("已恢复到最初位置")}O(t)},recoveryExcelData(t){try{this.excelData=JSON.parse(this.recoveryData),this.$set(this,"oldExcelData",[])}catch(e){alert("操作失败，已经是初始状态")}O(t)},async readExcel(t){this.loading=!0;const e=t.target.files[0],n=new FileReader;n.onload=t=>{const e=t.target.result,n=u.ij(e,{type:"binary"}),i=n.SheetNames[0],a=n.Sheets[i];this.$set(this,"excelData",u.P6.sheet_to_json(a)),this.$set(this,"recoveryData",JSON.stringify(this.excelData)),this.loading=!1},n.readAsBinaryString(e)},exportExcel(t){try{if(this.excelData.length<1)return alert("没有数据"),void O(t)}catch(s){return alert("操作错误"),void O(t)}const e=u.P6.json_to_sheet(this.excelData),n=u.P6.book_new();u.P6.book_append_sheet(n,e,"Sheet1");const i=u.cW(n,{bookType:"xlsx",type:"binary"}),a=new ArrayBuffer(i.length),l=new Uint8Array(a);for(let o=0;o<i.length;o++)l[o]=255&i.charCodeAt(o);(0,c.saveAs)(new Blob([a],{type:"application/octet-stream"}),"导出文件.xlsx"),O(t)}},computed:{paginatedData(){const t=(this.currentPage-1)*this.pageSize,e=t+this.pageSize;return this.excelData.slice(t,e)},totalPages(){return Math.ceil(this.excelData.length/this.pageSize)}}},C=V,E=(0,y.Z)(C,o,r,!1,null,"655cb8ba",null),N=E.exports,P={name:"App",components:{TranslateExcel:N}},I=P,L=(0,y.Z)(I,l,s,!1,null,null,null),$=L.exports,j=n(8499),A=n.n(j),T={install(t){t.prototype.$utils=i}};a["default"].use(T),a["default"].config.productionTip=!1,a["default"].use(A()),new a["default"]({render:t=>t($)}).$mount("#app")},7265:function(t){t.exports=JSON.parse('{"columnValueExist":"/search/columnValueExist?authorization=Tan","_columnValueExist":"查询数据是否存在，返回true or false请求参数为(String columnName,String value)","columnValueList":"/search/columnValueList?authorization=Tan","_columnValueList":"根据已输入内容进行模糊查询，返回合法的value列表，请求参数为(String columnName,String inputValue)"}')}},e={};function n(i){var a=e[i];if(void 0!==a)return a.exports;var l=e[i]={id:i,loaded:!1,exports:{}};return t[i].call(l.exports,l,l.exports,n),l.loaded=!0,l.exports}n.m=t,function(){n.amdO={}}(),function(){var t=[];n.O=function(e,i,a,l){if(!i){var s=1/0;for(c=0;c<t.length;c++){i=t[c][0],a=t[c][1],l=t[c][2];for(var o=!0,r=0;r<i.length;r++)(!1&l||s>=l)&&Object.keys(n.O).every((function(t){return n.O[t](i[r])}))?i.splice(r--,1):(o=!1,l<s&&(s=l));if(o){t.splice(c--,1);var u=a();void 0!==u&&(e=u)}}return e}l=l||0;for(var c=t.length;c>0&&t[c-1][2]>l;c--)t[c]=t[c-1];t[c]=[i,a,l]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){n.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){var t={143:0};n.O.j=function(e){return 0===t[e]};var e=function(e,i){var a,l,s=i[0],o=i[1],r=i[2],u=0;if(s.some((function(e){return 0!==t[e]}))){for(a in o)n.o(o,a)&&(n.m[a]=o[a]);if(r)var c=r(n)}for(e&&e(i);u<s.length;u++)l=s[u],n.o(t,l)&&t[l]&&t[l][0](),t[l]=0;return n.O(c)},i=self["webpackChunktest"]=self["webpackChunktest"]||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var i=n.O(void 0,[998],(function(){return n(8780)}));i=n.O(i)})();
//# sourceMappingURL=app.051537ab.js.map